---
- name: "module_bigip_virtual_server"
  hosts: all
  # hosts: localhost, Define the --limit localhost.
  # connection: Define the variable ansible_connection in the inventory
  # become: Define the variable ansible_become in the inventory
  # gather_facts: Define the variable ansible_gather_facts in the inventory
  vars:
    bigip_virtual_server: 
      rate_limit_src_mask: "{{ bigip_virtual_server_rate_limit_src_mask | default(omit, True) }}"
      fallback_persistence_profile: "{{ bigip_virtual_server_fallback_persistence_profile | default(omit, True) }}"
      rate_limit: "{{ bigip_virtual_server_rate_limit | default(omit, True) }}"
      default_persistence_profile: "{{ bigip_virtual_server_default_persistence_profile | default(omit, True) }}"
      firewall_enforced_policy: "{{ bigip_virtual_server_firewall_enforced_policy | default(omit, True) }}"
      enabled_vlans: "{{ bigip_virtual_server_enabled_vlans | default(omit, True) }}"
      mirror: "{{ bigip_virtual_server_mirror | default(omit, True) }}"
      port: "{{ bigip_virtual_server_port | default(omit, True) }}"
      description: "{{ bigip_virtual_server_description | default(omit, True) }}"
      policies: "{{ bigip_virtual_server_policies | default(omit, True) }}"
      destination: "{{ bigip_virtual_server_destination | default(omit, True) }}"
      rate_limit_mode: "{{ bigip_virtual_server_rate_limit_mode | default(omit, True) }}"
      irules: "{{ bigip_virtual_server_irules | default(omit, True) }}"
      source: "{{ bigip_virtual_server_source | default(omit, True) }}"
      state: "{{ bigip_virtual_server_state | default(omit, True) }}"
      pool: "{{ bigip_virtual_server_pool | default(omit, True) }}"
      server_port: "{{ bigip_virtual_server_server_port | default(omit, True) }}"
      provider: "{{ bigip_virtual_server_provider | default(omit, True) }}"
      security_nat_policy: "{{ bigip_virtual_server_security_nat_policy | default(omit, True) }}"
      ip_intelligence_policy: "{{ bigip_virtual_server_ip_intelligence_policy | default(omit, True) }}"
      address_translation: "{{ bigip_virtual_server_address_translation | default(omit, True) }}"
      type: "{{ bigip_virtual_server_type | default(omit, True) }}"
      metadata: "{{ bigip_virtual_server_metadata | default(omit, True) }}"
      disabled_vlans: "{{ bigip_virtual_server_disabled_vlans | default(omit, True) }}"
      ip_protocol: "{{ bigip_virtual_server_ip_protocol | default(omit, True) }}"
      firewall_staged_policy: "{{ bigip_virtual_server_firewall_staged_policy | default(omit, True) }}"
      user: "{{ bigip_virtual_server_user | default(omit, True) }}"
      password: "{{ bigip_virtual_server_password | default(omit, True) }}"
      rate_limit_dst_mask: "{{ bigip_virtual_server_rate_limit_dst_mask | default(omit, True) }}"
      security_log_profiles: "{{ bigip_virtual_server_security_log_profiles | default(omit, True) }}"
      name: "{{ bigip_virtual_server_name | default(omit, True) }}"
      snat: "{{ bigip_virtual_server_snat | default(omit, True) }}"
      partition: "{{ bigip_virtual_server_partition | default(omit, True) }}"
      mask: "{{ bigip_virtual_server_mask | default(omit, True) }}"
      profiles: "{{ bigip_virtual_server_profiles | default(omit, True) }}"
      server: "{{ bigip_virtual_server_server | default(omit, True) }}"
      clone_pools: "{{ bigip_virtual_server_clone_pools | default(omit, True) }}"
      insert_metadata: "{{ bigip_virtual_server_insert_metadata | default(omit, True) }}"
      source_port: "{{ bigip_virtual_server_source_port | default(omit, True) }}"
      validate_certs: "{{ bigip_virtual_server_validate_certs | default(omit, True) }}"
      port_translation: "{{ bigip_virtual_server_port_translation | default(omit, True) }}"
  tasks:
    - name: "plugin_bigip_virtual_server"
      bigip_virtual_server: "{{ bigip_virtual_server }}"
      register: r_bigip_virtual_server

    - name: "export r_bigip_virtual_server"
      set_stats:
        data:
          r_bigip_virtual_server: "{{ r_bigip_virtual_server }}"
