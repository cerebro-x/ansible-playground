---
- name: "module_proxmox_kvm"
  hosts: all
  # hosts: localhost, Define the --limit localhost.
  # connection: Define the variable ansible_connection in the inventory
  # become: Define the variable ansible_become in the inventory
  # gather_facts: Define the variable ansible_gather_facts in the inventory
  vars:
    proxmox_kvm: 
      revert: "{{ proxmox_kvm_revert | default(omit, True) }}"
      force: "{{ proxmox_kvm_force | default(omit, True) }}"
      storage: "{{ proxmox_kvm_storage | default(omit, True) }}"
      skiplock: "{{ proxmox_kvm_skiplock | default(omit, True) }}"
      startup: "{{ proxmox_kvm_startup | default(omit, True) }}"
      migrate_speed: "{{ proxmox_kvm_migrate_speed | default(omit, True) }}"
      freeze: "{{ proxmox_kvm_freeze | default(omit, True) }}"
      full: "{{ proxmox_kvm_full | default(omit, True) }}"
      keyboard: "{{ proxmox_kvm_keyboard | default(omit, True) }}"
      watchdog: "{{ proxmox_kvm_watchdog | default(omit, True) }}"
      serial: "{{ proxmox_kvm_serial | default(omit, True) }}"
      sockets: "{{ proxmox_kvm_sockets | default(omit, True) }}"
      digest: "{{ proxmox_kvm_digest | default(omit, True) }}"
      description: "{{ proxmox_kvm_description | default(omit, True) }}"
      startdate: "{{ proxmox_kvm_startdate | default(omit, True) }}"
      tablet: "{{ proxmox_kvm_tablet | default(omit, True) }}"
      hostpci: "{{ proxmox_kvm_hostpci | default(omit, True) }}"
      cpuunits: "{{ proxmox_kvm_cpuunits | default(omit, True) }}"
      cpu: "{{ proxmox_kvm_cpu | default(omit, True) }}"
      balloon: "{{ proxmox_kvm_balloon | default(omit, True) }}"
      scsihw: "{{ proxmox_kvm_scsihw | default(omit, True) }}"
      boot: "{{ proxmox_kvm_boot | default(omit, True) }}"
      reboot: "{{ proxmox_kvm_reboot | default(omit, True) }}"
      shares: "{{ proxmox_kvm_shares | default(omit, True) }}"
      name: "{{ proxmox_kvm_name | default(omit, True) }}"
      machine: "{{ proxmox_kvm_machine | default(omit, True) }}"
      bios: "{{ proxmox_kvm_bios | default(omit, True) }}"
      state: "{{ proxmox_kvm_state | default(omit, True) }}"
      template: "{{ proxmox_kvm_template | default(omit, True) }}"
      memory: "{{ proxmox_kvm_memory | default(omit, True) }}"
      net: "{{ proxmox_kvm_net | default(omit, True) }}"
      migrate_downtime: "{{ proxmox_kvm_migrate_downtime | default(omit, True) }}"
      localtime: "{{ proxmox_kvm_localtime | default(omit, True) }}"
      node: "{{ proxmox_kvm_node | default(omit, True) }}"
      agent: "{{ proxmox_kvm_agent | default(omit, True) }}"
      virtio: "{{ proxmox_kvm_virtio | default(omit, True) }}"
      autostart: "{{ proxmox_kvm_autostart | default(omit, True) }}"
      format: "{{ proxmox_kvm_format | default(omit, True) }}"
      clone: "{{ proxmox_kvm_clone | default(omit, True) }}"
      args: "{{ proxmox_kvm_args | default(omit, True) }}"
      api_password: "{{ proxmox_kvm_api_password | default(omit, True) }}"
      snapname: "{{ proxmox_kvm_snapname | default(omit, True) }}"
      tdf: "{{ proxmox_kvm_tdf | default(omit, True) }}"
      kvm: "{{ proxmox_kvm_kvm | default(omit, True) }}"
      sata: "{{ proxmox_kvm_sata | default(omit, True) }}"
      protection: "{{ proxmox_kvm_protection | default(omit, True) }}"
      numa: "{{ proxmox_kvm_numa | default(omit, True) }}"
      api_user: "{{ proxmox_kvm_api_user | default(omit, True) }}"
      parallel: "{{ proxmox_kvm_parallel | default(omit, True) }}"
      pool: "{{ proxmox_kvm_pool | default(omit, True) }}"
      api_host: "{{ proxmox_kvm_api_host | default(omit, True) }}"
      lock: "{{ proxmox_kvm_lock | default(omit, True) }}"
      ide: "{{ proxmox_kvm_ide | default(omit, True) }}"
      target: "{{ proxmox_kvm_target | default(omit, True) }}"
      hotplug: "{{ proxmox_kvm_hotplug | default(omit, True) }}"
      vga: "{{ proxmox_kvm_vga | default(omit, True) }}"
      update: "{{ proxmox_kvm_update | default(omit, True) }}"
      vmid: "{{ proxmox_kvm_vmid | default(omit, True) }}"
      hugepages: "{{ proxmox_kvm_hugepages | default(omit, True) }}"
      bootdisk: "{{ proxmox_kvm_bootdisk | default(omit, True) }}"
      acpi: "{{ proxmox_kvm_acpi | default(omit, True) }}"
      vcpus: "{{ proxmox_kvm_vcpus | default(omit, True) }}"
      newid: "{{ proxmox_kvm_newid | default(omit, True) }}"
      timeout: "{{ proxmox_kvm_timeout | default(omit, True) }}"
      smbios: "{{ proxmox_kvm_smbios | default(omit, True) }}"
      ostype: "{{ proxmox_kvm_ostype | default(omit, True) }}"
      cores: "{{ proxmox_kvm_cores | default(omit, True) }}"
      scsi: "{{ proxmox_kvm_scsi | default(omit, True) }}"
      cpulimit: "{{ proxmox_kvm_cpulimit | default(omit, True) }}"
      validate_certs: "{{ proxmox_kvm_validate_certs | default(omit, True) }}"
      onboot: "{{ proxmox_kvm_onboot | default(omit, True) }}"
      delete: "{{ proxmox_kvm_delete | default(omit, True) }}"
  tasks:
    - name: "plugin_proxmox_kvm"
      proxmox_kvm: "{{ proxmox_kvm }}"
      register: r_proxmox_kvm

    - name: "export r_proxmox_kvm"
      set_stats:
        data:
          r_proxmox_kvm: "{{ r_proxmox_kvm }}"
