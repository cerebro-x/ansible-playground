---
- name: "module_openssl_csr"
  hosts: all
  # hosts: localhost, Define the --limit localhost.
  # connection: Define the variable ansible_connection in the inventory
  # become: Define the variable ansible_become in the inventory
  # gather_facts: Define the variable ansible_gather_facts in the inventory
  vars:
    openssl_csr: 
      privatekey_passphrase: "{{ openssl_csr_privatekey_passphrase | default(omit, True) }}"
      force: "{{ openssl_csr_force | default(omit, True) }}"
      subject_alt_name_critical: "{{ openssl_csr_subject_alt_name_critical | default(omit, True) }}"
      owner: "{{ openssl_csr_owner | default(omit, True) }}"
      ocsp_must_staple: "{{ openssl_csr_ocsp_must_staple | default(omit, True) }}"
      key_usage: "{{ openssl_csr_key_usage | default(omit, True) }}"
      common_name: "{{ openssl_csr_common_name | default(omit, True) }}"
      email_address: "{{ openssl_csr_email_address | default(omit, True) }}"
      digest: "{{ openssl_csr_digest | default(omit, True) }}"
      subject: "{{ openssl_csr_subject | default(omit, True) }}"
      group: "{{ openssl_csr_group | default(omit, True) }}"
      organizational_unit_name: "{{ openssl_csr_organizational_unit_name | default(omit, True) }}"
      unsafe_writes: "{{ openssl_csr_unsafe_writes | default(omit, True) }}"
      locality_name: "{{ openssl_csr_locality_name | default(omit, True) }}"
      serole: "{{ openssl_csr_serole | default(omit, True) }}"
      organization_name: "{{ openssl_csr_organization_name | default(omit, True) }}"
      state: "{{ openssl_csr_state | default(omit, True) }}"
      version: "{{ openssl_csr_version | default(omit, True) }}"
      country_name: "{{ openssl_csr_country_name | default(omit, True) }}"
      setype: "{{ openssl_csr_setype | default(omit, True) }}"
      state_or_province_name: "{{ openssl_csr_state_or_province_name | default(omit, True) }}"
      extended_key_usage_critical: "{{ openssl_csr_extended_key_usage_critical | default(omit, True) }}"
      subject_alt_name: "{{ openssl_csr_subject_alt_name | default(omit, True) }}"
      selevel: "{{ openssl_csr_selevel | default(omit, True) }}"
      basic_constraints: "{{ openssl_csr_basic_constraints | default(omit, True) }}"
      privatekey_path: "{{ openssl_csr_privatekey_path | default(omit, True) }}"
      path: "{{ openssl_csr_path | default(omit, True) }}"
      key_usage_critical: "{{ openssl_csr_key_usage_critical | default(omit, True) }}"
      extended_key_usage: "{{ openssl_csr_extended_key_usage | default(omit, True) }}"
      backup: "{{ openssl_csr_backup | default(omit, True) }}"
      seuser: "{{ openssl_csr_seuser | default(omit, True) }}"
      use_common_name_for_san: "{{ openssl_csr_use_common_name_for_san | default(omit, True) }}"
      mode: "{{ openssl_csr_mode | default(omit, True) }}"
      basic_constraints_critical: "{{ openssl_csr_basic_constraints_critical | default(omit, True) }}"
      select_crypto_backend: "{{ openssl_csr_select_crypto_backend | default(omit, True) }}"
      attributes: "{{ openssl_csr_attributes | default(omit, True) }}"
      ocsp_must_staple_critical: "{{ openssl_csr_ocsp_must_staple_critical | default(omit, True) }}"
  tasks:
    - name: "plugin_openssl_csr"
      openssl_csr: "{{ openssl_csr }}"
      register: r_openssl_csr

    - name: "export r_openssl_csr"
      set_stats:
        data:
          r_openssl_csr: "{{ r_openssl_csr }}"
